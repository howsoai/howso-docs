#################
Time Series Types
#################

What you'll learn in this page
==============================

In this guide, you will learn about the three time series types for continuous features, how to configure them, and how they differ.

How to specify the time-series types of your features?
======================================================
Time-series types are specified in the feature attributes and the :py:func:`~howso.utilities.infer_feature_attributes`
function provides parameters to make configuring the types easy.

Specifically, there are two parameters: `time_series_type_default` and `time_series_types_override`.

`time_series_type_default` accepts one of the 3 types as a string ("rate", "delta", or "covariate") and that
will be the type assigned to all continuous time-series features that are not specifically given an override
in the other parameter, `time_series_types_override`.

`time_series_types_override` accepts a mapping of feature name to one of the 3 time-series types as a string.
Below is an example of how to use both of these parameters to set "rate" as the default type, but "covariate"
for two specific features.

.. code-block:: python

    features = infer_feature_attributes(
        df,
        time_series_type_default="rate",
        time_series_types_override={"feature_name1": "covariate", "feature_name2": "covariate"}
    )

Note that "rate" is the default type for continuous time-dependent features.

How does each time-series type work?
====================================

When modeling time-dependent continuous features, Howso Engine currently supports three modes of temporal
modeling: "rate", "delta", and "covariate".

Rate
----
When using the "rate" time-series type, values for the feature are generated by predicting the rate of change of the
feature and using this predicted rate of change to extrapolate from the previous value. The modelling order of the
rate modeling can be specified as well, allowing the prediction of multiple orders as needed.

The simplest case (1 order) of a "rate" feature value derivation is as follows:

.. math::

   f_{i} = f_{i-1} + \hat{t\Delta} * \hat{f'_{i}}


Delta
-----
"Delta" is in some ways a special form of rate. The difference is that rather than predicting the *rate* of change,
the model predicts the absolute change and adds that value to the previous value. The time delta is not part of the
feature derivation when using "delta". This makes "delta" useful in datasets where the passing of time may
be unrelated to the change in a feature's values.

The derivation for a "delta" feature looks like the following:

.. math::

   f_{i} = f_{i-1} + \hat{f\Delta}


Covariate
---------
Unlike "delta" and "rate", "covariate" is unique in that it does not use the previous feature value to derive the
next value. Features specified as "covariate" have their next value
generated by simply predicting the next feature value directly. All the available contexts are used, such as other
feature values and their lags, but there is no derivation of the next value using the previous value. This makes
"covariate" the correct choice when you have reason to believe the values of a feature are not necessarily a function
of their previous value.
